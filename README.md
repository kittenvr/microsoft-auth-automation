# Playwright Login with Bitwarden Integration

This script automates login to Microsoft services using credentials stored securely in Bitwarden.

> [!WARNING]
> This project was fully generated by an AI assistant. Please review all code carefully before use.
>
> - The code may contain bugs or security issues not immediately apparent
> - Always verify functionality in a safe testing environment first
> - Some implementations may be overly complex or have unintended side effects
> - Review all credential handling and security practices before deployment
> - Generated code should be audited by a human developer before production use
> - The author is not responsible if your Microsoft account gets banned due to automation usage

## Purpose

This script automates login to Microsoft services using credentials stored securely in Bitwarden.

## Prerequisites

1. Bitwarden CLI installed
2. Login credentials stored in your Bitwarden vault

## Setup

### 1. Install Bitwarden CLI

```bash
npm install -g @bitwarden/cli
```

### 2. Create your environment file

Copy the example environment file and add your credentials:

```bash
cp .env.example .env
```

Then edit `.env` and add your credentials:

```env
BW_EMAIL=your-bitwarden-email@example.com
BW_PASSWORD=your-bitwarden-master-password
BW_SERVER=https://vault.bitwarden.com  # Optional: omit for official server, or specify for self-hosted
DOMAIN=yourdomain.com  # Domain to use for catchall email address (used in changeemail.js)
```

**Important**: Add `.env` to your `.gitignore` to prevent committing sensitive data:
```bash
echo ".env" >> .gitignore
```

### 3. Store your credentials in Bitwarden

Make sure you have a login item in your Bitwarden vault for 'login.live.com' or 'microsoft' with:
- Username (email)
- Password

## Usage

### For login with code:
```bash
node node.js <CODE>
```

For example:
```bash
node node.js ATPRQZBS
```

### For changing email/recovery email:
```bash
node changeemail.js <RECOVERY_EMAIL>
```

For example:
```bash
node changeemail.js newrecovery@example.com
```

## How it works

The script:

1. Gets your Bitwarden credentials from environment variables
2. Logs into Bitwarden automatically using these credentials
3. Gets the access code from command line argument
4. Searches for login items matching 'login.live.com' or 'microsoft'
5. If multiple Microsoft accounts are found, prompts you to select one, showing the name and email of each
6. Extracts the email and password from the selected item
7. Uses these credentials in the Playwright automation

## Security Notes

- Never commit your .env file with sensitive information
- The script accesses credentials that match the target domain from your Bitwarden vault
- Your Bitwarden master password is only used to authenticate with Bitwarden